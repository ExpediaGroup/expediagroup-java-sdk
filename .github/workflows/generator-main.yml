name: Generate SDK - Main
on:
  workflow_dispatch:
    inputs:
      name:
        description: 'SDK Name'
        required: true
      version:
        description: 'SDK Version'
        required: false
        default: ''
      test:
        description: 'Release a Snapshot?'
        required: false
jobs:
  prepare_version:
    uses: ./.github/workflows/generator-prepare-version.yml
    with:
      name: ${{ github.event.inputs.name }}
      version: ${{ github.event.inputs.version }}
  generate:
    needs: [ prepare_version ]
    uses: ./.github/workflows/generator-generate.yml
    with:
      name: ${{ github.event.inputs.name }}
      version: ${{ needs.prepare_version.outputs.version }}
      specs: ./release/${{ github.event.inputs.name }}/specs.yaml
  publish_sources:
    uses: ./github/workflows/generator-generate-and-publish-sources-action.yml
    with:
      name: ${{ github.event.inputs.name }}
      version: ${{ github.event.inputs.version }}
      specs: ./release/${{ github.event.inputs.name }}/specs.yaml
  # publish:
  #   needs: [ generate ]
  #   uses: ./.github/workflows/generator-publish.yml
  #   secrets: inherit
  #   with:
  #     test: ${{ github.event.inputs.test }}
